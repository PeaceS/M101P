import pymongo
import sys

# establish a connection to the database
connection = pymongo.Connection("mongodb://localhost", safe=True)

# get a handle to the school database
db=connection.school
student = db.students


def delete():

    query = {}

    try:
        cursor = student.find(query)
        cursor = cursor.sort({'_id',pymongo.ASCENDING})

    except:
        print "Unexpected error:", sys.exc_info()[0]

    sanity = 0
    for doc in cursor:
      try:
        query_2 = {'_id':doc['_id']}
        cursor_2 = student.find(query_2)
        cursor_2 = cursor_2.sort({'scores.score',pymongo.ASCENDING})
        for doc_2 in cursor_2:
          if doc_2['scores.type'] == 'homework':
            print "Found: %s of %s" % (doc['scores.score'], doc['_id'])
      except:
        print "Cannot delete:", sys.exc_info()[0]
                    
delete()
